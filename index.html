<html>
    
    <head>
        <title>Web Parrot</title>
    </head>
    
    <body>
        <br><br><br>
        <center>Allow microphone access to begin.</center>
    </body>
    
    <script>
        if(window.location.href.indexOf("https")<0){
            window.location.href = "https"+window.location.href.substring(4);
        }
        
        window.AudioContext = window.AudioContext || window.webkitAudioContext;
        navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;
        window.addEventListener('load', init, false);
        
        var recorder;
        
        function stop(){
            recorder.stop();
            recorder.exportWAV(function(s) {
                audio.src = window.URL.createObjectURL(s);
            });
        }
        
        function sound (stream) {
            var context = new webkitAudioContext();
            var mediaStreamSource = context.createMediaStreamSource(stream);
            recorder = new Recorder(mediaStreamSource);
            recorder.record();
            setTimeout(stop, 3000);
        }
    
        function error () {
            console.log(arguments);
        }
    
        function init(){
            navigator.getUserMedia({ audio: true }, sound, error);
        }
    
    
    </script>
    
</html>